<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Management</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);}
        h1 { text-align: center; margin-bottom: 20px; color: #333;}
        form div { margin-bottom: 15px;}
        label { display:block; margin-bottom:5px;}
        input, select, textarea { width:100%; padding:8px; border-radius:4px; border:1px solid #ccc; }
        button { padding:10px 20px; border:none; border-radius:4px; cursor:pointer;}
        .btn-primary { background:#667eea; color:#fff; }
        .btn-secondary { background:#6c757d; color:#fff; }
        table { width:100%; border-collapse: collapse; margin-top:20px; }
        th, td { border:1px solid #ddd; padding:10px; text-align:center; }
        th { background:#667eea; color:#fff; }
        img { width:50px; height:50px; object-fit:cover; border-radius:4px;}
    </style>
</head>
<body>

<div class="container">
    <h1>Product Management System</h1>

    <form id="productForm" enctype="multipart/form-data">
        <input type="hidden" id="productId" name="productId">
        <div>
            <label>Title *</label>
            <input type="text" id="title" name="title" required>
        </div>
        <div>
            <label>Brand *</label>
            <select id="brandId" name="brandId" required>
                <option value="">Select Brand</option>
                <option value="1">Apple</option>
                <option value="2">Samsung</option>
            </select>
        </div>
        <div>
            <label>Model *</label>
            <select id="modelId" name="modelId" required>
                <option value="">Select Model</option>
                <option value="1">iPhone 15 Pro</option>
                <option value="2">Galaxy S24</option>
            </select>
        </div>
        <div>
            <label>Description *</label>
            <textarea id="description" name="description" required></textarea>
        </div>
        <div>
            <label>Price *</label>
            <input type="number" id="price" name="price" step="0.01" min="0" required>
        </div>
        <div>
            <label>Quantity *</label>
            <input type="number" id="qty" name="qty" min="1" required>
        </div>
        <div>
            <label>Storage *</label>
            <select id="storageId" name="storageId" required>
                <option value="">Select Storage</option>
                <option value="1">128GB</option>
                <option value="2">256GB</option>
            </select>
        </div>
        <div>
            <label>Color *</label>
            <select id="colorId" name="colorId" required>
                <option value="">Select Color</option>
                <option value="1">Black</option>
                <option value="2">White</option>
            </select>
        </div>
        <div>
            <label>Condition *</label>
            <select id="conditionId" name="conditionId" required>
                <option value="">Select Condition</option>
                <option value="1">Brand New</option>
                <option value="2">Like New</option>
            </select>
        </div>
        <div>
            <label>Image 1 *</label>
            <input type="file" id="image1" name="image1" accept="image/*" required>
        </div>
        <div>
            <label>Image 2 *</label>
            <input type="file" id="image2" name="image2" accept="image/*" required>
        </div>
        <div>
            <label>Image 3 *</label>
            <input type="file" id="image3" name="image3" accept="image/*" required>
        </div>

        <div>
            <button type="submit" class="btn-primary">Save Product</button>
            <button type="button" class="btn-secondary" onclick="resetForm()">Clear Form</button>
        </div>
    </form>

    <table id="productTable">
        <thead>
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Model</th>
            <th>Price</th>
            <th>Qty</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody id="productTableBody">
        <!-- Products will be loaded here -->
        </tbody>
    </table>
</div>

<script>
    // Product array
    let products = [];

    // Form submit
    document.getElementById('productForm').addEventListener('submit', function(e){
        e.preventDefault();

        const formData = new FormData();
        formData.append("title", document.getElementById('title').value);
        formData.append("brandId", document.getElementById('brandId').value);
        formData.append("modelId", document.getElementById('modelId').value);
        formData.append("description", document.getElementById('description').value);
        formData.append("price", document.getElementById('price').value);
        formData.append("qty", document.getElementById('qty').value);
        formData.append("storageId", document.getElementById('storageId').value);
        formData.append("colorId", document.getElementById('colorId').value);
        formData.append("conditionId", document.getElementById('conditionId').value);
        formData.append("image1", document.getElementById('image1').files[0]);
        formData.append("image2", document.getElementById('image2').files[0]);
        formData.append("image3", document.getElementById('image3').files[0]);

        fetch('SaveProduct', {
            method: 'POST',
            body: formData
        }).then(response => response.json())
            .then(data => {
                if(data.status){
                    alert("✅ Product saved successfully!");
                    resetForm();
                    loadProducts(); // Optionally reload product list from backend
                } else {
                    alert("⚠️ Error: " + data.message);
                }
            }).catch(err => {
            alert("⚠️ Server error: " + err);
        });
    });

    function resetForm(){
        document.getElementById('productForm').reset();
    }

    function loadProducts(){
        // For demo, just reload local array
        const tbody = document.getElementById('productTableBody');
        tbody.innerHTML = '';
        products.forEach(p => {
            const row = `<tr>
                <td>${p.id || '-'}</td>
                <td>${p.title}</td>
                <td>${p.model}</td>
                <td>${p.price}</td>
                <td>${p.qty}</td>
                <td>
                    <button onclick="editProduct(${p.id})">Edit</button>
                    <button onclick="deleteProduct(${p.id})">Delete</button>
                </td>
            </tr>`;
            tbody.innerHTML += row;
        });
    }

    function editProduct(id){ alert("Edit product ID: "+id);}
    function deleteProduct(id){ alert("Delete product ID: "+id);}
</script>

</body>
</html>
